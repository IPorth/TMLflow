binaxis='y', stackdir='dodge', dotsize = 0.8,
position = position_dodge(2), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, color = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(10), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, color = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, color = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = all_goi$Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group, group=Group))+
geom_dotplot(
aes(fill = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group, group=gene))+
geom_dotplot(
aes(fill = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colors=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
?aes
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='x', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
subERBB2 <- filter( all_goi, gene %in% "ERBB2")
subERBB2
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, color = Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(2), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center')
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center',  binwidth = 0.2)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center',  binwidth = 0.5)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center',  binwidth = 10)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center',  binwidth = 5)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='x', stackdir='center',  binwidth = 5)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y',  binwidth = 5)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot()
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binwidth = 5)
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)
all_goi$Group<- as.character(all_goi$Group)
subERBB2 <- filter( all_goi, gene %in% "ERBB2")
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(200), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
ggplot
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')+
stat_summary(fun.y=mean, geom="point", shape=18, size=3, color="red")
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_boxplot(fill="white")+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')+
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
geom_boxplot(fill="white")+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
#geom_boxplot(fill="white")+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=Group, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center')
ggplot(all_goi, aes(x=Group, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 0.2)
ggplot(all_goi, aes(x=Group, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 0.5)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(aes(fill = Group, colour=Group),binaxis='y', stackdir='center', binwidth = 0.1)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_dotplot(aes(fill = Group, colour=Group), binaxis='y', stackdir='center', binwidth = 0.1,position = position_dodge(0.8)+
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white")+
geom_dotplot(aes(fill = Group, colour=Group), binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(position=position_dodge(0.8))+
geom_dotplot(aes(fill = Group, colour=Group), binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill="white", position=position_dodge(0.8))+
geom_dotplot(aes(fill = Group, colour=Group), binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( position=position_dodge(0.8))+
geom_dotplot(aes(fill = Group, colour=Group), binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill=c("white","grey") position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill=c("white","grey") position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill=c("white","grey"), position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill=Group,colour=c("white","grey"), position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(fill=c("white","grey"), position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( position=position_dodge(0.8))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( position=position_dodge(0.9))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.8))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( position=position_dodge(0.9))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(0.9))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( aes(middle = mean(copy.number)),position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( aes(middle = median(copy.number)),position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot( aes(middle = mean(copy.number)),position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(aes(middle = mean(copy.number)),position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(aes(middle = mean(copy.number)),position=position_dodge(1),stat="identity")+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
pat_info <- read_excel("C:/Users/ladmin/Documents/Doktorarbeit/Data/Kollektiv/Pat_groups_single_sample.xls")
CNV_data_path <- "Y:/MetGaP/Sequencing/Kollektiv/CNV/ONCOCNV/"
#Create empty data frames
amp_1 <- data.frame(matrix(ncol = 9, nrow = 0))
amp_2 <- data.frame(matrix(ncol = 9, nrow = 0))
val_amp <- data.frame(matrix(ncol = 9, nrow = 0))
goi_amp_1 <- data.frame(matrix(ncol = 9, nrow = 0))
goi_amp_2 <- data.frame(matrix(ncol = 9, nrow = 0))
goi <- c("CDK12", "ERBB2","PGAP3","RARA" )
#select amplifications and sort into dataframes
for(i in 1:length(pat_info$Pat)){
#load data
CNV_data <- read.table(paste(CNV_data_path, pat_info$Pat[i], "_merge.summary.txt", sep = ""),
header = TRUE, sep = "\t")
CNV_data_mod <- add_column(CNV_data, Pat = rep(pat_info$Pat[i], length(CNV_data$gene)), .before = "gene")
#Remove x chr
sub1 <- CNV_data_mod %>% filter(!chr =="chrX")
sub2 <- filter( CNV_data_mod, gene %in% goi)
#Select everything CN >2.5 and =1
amp <-CNV_data %>% filter(copy.number > 2.5)
#Add Pat name col
#Sort into dataframe
if (pat_info$Group[i]==1){
amp_1<- rbind(amp_1, amp)
goi_amp_1 <- rbind(goi_amp_1, sub2)
} else if (pat_info$Group[i]==2){
amp_2<- rbind(amp_2, amp)
goi_amp_2 <- rbind(goi_amp_2, sub2)
} else {
val_amp<- rbind(val_amp, amp)
}
}
high_amp_1 <-amp_1 %>% filter(copy.number >= 4)
high_amp_2 <-amp_2 %>% filter(copy.number >= 4)
goi_amp_1$Group <- rep(1, length(goi_amp_1$Pat))
goi_amp_2$Group <- rep(2, length(goi_amp_2$Pat))
all_goi <- rbind(goi_amp_1,goi_amp_2)
geneID <- c()
for (i in 1:length(all_goi$gene)){
if (all_goi$gene[i]==goi[1]){
geneID<- append(geneID, 1)
} else if(all_goi$gene[i]==goi[2]){
geneID<- append(geneID, 2)
}else if(all_goi$gene[i]==goi[3]){
geneID<- append(geneID, 3)
}else {
geneID<- append(geneID, 4)
}
}
all_goi$GeneID <- geneID
all_goi$Group<- as.character(all_goi$Group)
subERBB2 <- filter( all_goi, gene %in% "ERBB2")
ggplot(subERBB2, aes(x = Group, y = copy.number, fill=Group))+
geom_dotplot(binaxis='y', stackdir='center', binwidth = 5)
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
#geom_boxplot(fill="white")+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
pat_info <- read_excel("C:/Users/ladmin/Documents/Doktorarbeit/Data/Kollektiv/Pat_groups_single_sample.xls")
View(pat_info)
amp_1 <- data.frame(matrix(ncol = 10, nrow = 0))
amp_2 <- data.frame(matrix(ncol = 10, nrow = 0))
val_amp <- data.frame(matrix(ncol = 10, nrow = 0))
goi_amp_1 <- data.frame(matrix(ncol = 10, nrow = 0))
goi_amp_2 <- data.frame(matrix(ncol = 10, nrow = 0))
goi <- c("CDK12", "ERBB2","PGAP3","RARA" )
#select amplifications and sort into dataframes
for(i in 1:length(pat_info$Pat)){
#load data
CNV_data <- read.table(paste(CNV_data_path, pat_info$Pat[i], "_merge.summary.txt", sep = ""),
header = TRUE, sep = "\t")
CNV_data_mod <- add_column(CNV_data, Pat = rep(pat_info$Pat[i], length(CNV_data$gene)), .before = "gene")
CNV_data_mod <- add_column(CNV_data, Pat = rep(pat_info$PFS[i], length(CNV_data$gene)), .after = "Pat")
#Remove x chr
sub1 <- CNV_data_mod %>% filter(!chr =="chrX")
sub2 <- filter( CNV_data_mod, gene %in% goi)
#Select everything CN >2.5 and =1
amp <-CNV_data %>% filter(copy.number > 2.5)
#Add Pat name col
#Sort into dataframe
if (pat_info$Group[i]==1){
amp_1<- rbind(amp_1, amp)
goi_amp_1 <- rbind(goi_amp_1, sub2)
} else if (pat_info$Group[i]==2){
amp_2<- rbind(amp_2, amp)
goi_amp_2 <- rbind(goi_amp_2, sub2)
} else {
val_amp<- rbind(val_amp, amp)
}
}
amp_1 <- data.frame(matrix(ncol = 10, nrow = 0))
amp_2 <- data.frame(matrix(ncol = 10, nrow = 0))
val_amp <- data.frame(matrix(ncol = 10, nrow = 0))
goi_amp_1 <- data.frame(matrix(ncol = 10, nrow = 0))
goi_amp_2 <- data.frame(matrix(ncol = 10, nrow = 0))
goi <- c("CDK12", "ERBB2","PGAP3","RARA" )
#select amplifications and sort into dataframes
for(i in 1:length(pat_info$Pat)){
#load data
CNV_data <- read.table(paste(CNV_data_path, pat_info$Pat[i], "_merge.summary.txt", sep = ""),
header = TRUE, sep = "\t")
CNV_data_mod <- add_column(CNV_data, Pat = rep(pat_info$Pat[i], length(CNV_data$gene)), .before = "gene")
CNV_data_mod <- add_column(CNV_data, PFS = rep(pat_info$PFS[i], length(CNV_data$gene)), .after = "Pat")
#Remove x chr
sub1 <- CNV_data_mod %>% filter(!chr =="chrX")
sub2 <- filter( CNV_data_mod, gene %in% goi)
#Select everything CN >2.5 and =1
amp <-CNV_data %>% filter(copy.number > 2.5)
#Add Pat name col
#Sort into dataframe
if (pat_info$Group[i]==1){
amp_1<- rbind(amp_1, amp)
goi_amp_1 <- rbind(goi_amp_1, sub2)
} else if (pat_info$Group[i]==2){
amp_2<- rbind(amp_2, amp)
goi_amp_2 <- rbind(goi_amp_2, sub2)
} else {
val_amp<- rbind(val_amp, amp)
}
}
#select amplifications and sort into dataframes
for(i in 1:length(pat_info$Pat)){
#load data
CNV_data <- read.table(paste(CNV_data_path, pat_info$Pat[i], "_merge.summary.txt", sep = ""),
header = TRUE, sep = "\t")
CNV_data_mod <- add_column(CNV_data, Pat = rep(pat_info$Pat[i], length(CNV_data$gene)), .before = "gene")
CNV_data_mod <- add_column(CNV_data_mod, PFS = rep(pat_info$PFS[i], length(CNV_data$gene)), .after = "Pat")
#Remove x chr
sub1 <- CNV_data_mod %>% filter(!chr =="chrX")
sub2 <- filter( CNV_data_mod, gene %in% goi)
#Select everything CN >2.5 and =1
amp <-CNV_data %>% filter(copy.number > 2.5)
#Add Pat name col
#Sort into dataframe
if (pat_info$Group[i]==1){
amp_1<- rbind(amp_1, amp)
goi_amp_1 <- rbind(goi_amp_1, sub2)
} else if (pat_info$Group[i]==2){
amp_2<- rbind(amp_2, amp)
goi_amp_2 <- rbind(goi_amp_2, sub2)
} else {
val_amp<- rbind(val_amp, amp)
}
}
high_amp_1 <-amp_1 %>% filter(copy.number >= 4)
high_amp_2 <-amp_2 %>% filter(copy.number >= 4)
goi_amp_1$Group <- rep(1, length(goi_amp_1$Pat))
goi_amp_2$Group <- rep(2, length(goi_amp_2$Pat))
all_goi <- rbind(goi_amp_1,goi_amp_2)
install.packages("ggpubr")
library(ggpubr)
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x = gene, y = copy.number, fill=Group))+
#geom_boxplot(fill="white")+
geom_dotplot(
aes(fill = Group, colour=Group),
binaxis='y', stackdir='center', dotsize = 0.8,
position = position_dodge(0.8), binwidth = 0.2)+
scale_y_continuous(trans = 'log2')
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
all_goi$GeneID <- geneID
all_goi$Group<- as.character(all_goi$Group)
subERBB2 <- filter( all_goi, gene %in% "ERBB2")
ggplot(all_goi, aes(x=gene, y=copy.number, fill=Group)) +
geom_boxplot(position=position_dodge(1))+
geom_dotplot( binaxis='y', stackdir='center',
binwidth = 0.1,position = position_dodge(1))+
scale_y_continuous(trans = 'log2')
subERBB2
ggscatter(subERBB2, x = "PFS", y = "copy.number",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Progression free survival (PFS)", ylab = "ERBB2 copy number")
ggscatter(subERBB2, x = "copy.number", y = "PFS",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Progression free survival (PFS)", ylab = "ERBB2 copy number")
ggscatter(subERBB2, x = "PFS", y = "copy.number",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Progression free survival (PFS)", ylab = "ERBB2 copy number")
subRARA <- filter( all_goi, gene %in% "RARA")
ggscatter(subRARA, x = "PFS", y = "copy.number",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Progression free survival (PFS)", ylab = "RARA copy number")
subCDK12 <- filter( all_goi, gene %in% "CDK12")
ggscatter(subCDK12, x = "PFS", y = "copy.number",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Progression free survival (PFS)", ylab = "CDK12 copy number")
goi
subPGAP3 <- filter( all_goi, gene %in% "PGAP3")
ggscatter(subPGAP3, x = "PFS", y = "copy.number",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Progression free survival (PFS)", ylab = "PGAP3 copy number")
foldchange
?foldchange
??foldchange#
??foldchange
install.packages(gtools)
install.packages("gtools")
library(gtools)
test <- all_goi$copy.number/2
test
all_goi$ratio <- all_goi$copy.number/2
h
?gtools
